# 上傳問題排查指南

## 問題：錄影沒有寫到伺服器

### 檢查步驟

1. **確認伺服器正在運行**
   ```bash
   npm start
   ```
   應該看到：`Server running on http://localhost:3000`

2. **確認使用正確的 URL**
   - ✅ 正確：`http://localhost:3000` 或 `https://your-server.com:3000`
   - ❌ 錯誤：`http://localhost:8000` (Python 伺服器，沒有 API)

3. **檢查瀏覽器控制台**
   - 按 F12 開啟開發者工具
   - 查看 Console 標籤
   - 應該看到：
     - `API Base URL: http://localhost:3000`
     - `Starting upload...`
     - `Upload successful:`

4. **檢查伺服器日誌**
   - 在終端查看伺服器輸出
   - 應該看到：
     - `Upload request received`
     - `File: { filename: ..., size: ... }`
     - `Sessions saved, total: X`

### 常見問題

#### 問題 1：使用 Python 伺服器 (8000 端口)

**症狀**：通過 `http://localhost:8000` 訪問，無法上傳

**原因**：Python 伺服器只提供靜態文件，沒有 API 端點

**解決**：
- 停止 Python 伺服器
- 使用 Node.js 伺服器：`npm start`
- 通過 `http://localhost:3000` 訪問

#### 問題 2：API URL 錯誤

**症狀**：控制台顯示錯誤的 API URL

**檢查**：
```javascript
// 在瀏覽器控制台執行
console.log('API Base URL:', API_BASE_URL);
```

**應該顯示**：`http://localhost:3000` 或 `https://your-server.com:3000`

#### 問題 3：CORS 錯誤

**症狀**：控制台顯示 CORS 錯誤

**解決**：伺服器已配置 CORS，如果仍有問題，檢查：
- 伺服器是否正在運行
- 是否使用正確的協議（http/https）

#### 問題 4：網路錯誤

**症狀**：`Failed to fetch` 或 `Network error`

**檢查**：
- 伺服器是否正在運行
- 防火牆是否阻擋
- 網路連線是否正常

### 測試上傳功能

1. **開啟瀏覽器控制台** (F12)
2. **錄製一段影片**
3. **停止錄影**
4. **查看控制台輸出**：
   ```
   Starting upload... {sessionId: "...", blobSize: ..., apiUrl: "..."}
   Sending request to: http://localhost:3000/api/upload
   Response status: 200 OK
   Upload successful: {success: true, sessionId: "..."}
   ```
5. **查看伺服器終端**：
   ```
   Upload request received
   File: { filename: "...", size: ... }
   Sessions saved, total: X
   ```

### 驗證上傳成功

1. **檢查檔案系統**：
   ```bash
   ls -lh uploads/
   ```
   應該看到上傳的影片檔案

2. **檢查 sessions.json**：
   ```bash
   cat sessions.json
   ```
   應該看到會話資料

3. **在管理介面查看**：
   - 重新整理頁面
   - 應該看到新錄製的影片

### 除錯模式

如果仍有問題，檢查：

1. **瀏覽器控制台錯誤訊息**
2. **伺服器終端錯誤訊息**
3. **網路標籤** (F12 → Network)：
   - 查看 `/api/upload` 請求
   - 檢查狀態碼和回應

### 聯絡資訊

如果問題持續，請提供：
- 瀏覽器控制台的完整錯誤訊息
- 伺服器終端的完整輸出
- 使用的 URL 和端口

